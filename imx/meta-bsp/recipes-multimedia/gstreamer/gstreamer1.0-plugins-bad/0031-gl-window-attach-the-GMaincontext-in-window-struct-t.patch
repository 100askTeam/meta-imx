From a87fade2a390f43177abefeafa14abe4a5e64eeb Mon Sep 17 00:00:00 2001
From: Haihua Hu <jared.hu@nxp.com>
Date: Wed, 8 Feb 2017 00:45:32 +0800
Subject: [PATCH] gl/window: attach the GMaincontext in window struct to
 GSource for X11 window

Upstream-Status: Backport [1.10.4]
https://bugzilla.gnome.org/show_bug.cgi?id=778297

Signed-off-by: Haihua Hu <jared.hu@nxp.com>
---
 gst-libs/gst/gl/x11/gstglwindow_x11.c | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/gst-libs/gst/gl/x11/gstglwindow_x11.c b/gst-libs/gst/gl/x11/gstglwindow_x11.c
index bc7b9c0..585072e 100644
--- a/gst-libs/gst/gl/x11/gstglwindow_x11.c
+++ b/gst-libs/gst/gl/x11/gstglwindow_x11.c
@@ -173,8 +173,7 @@ gst_gl_window_x11_open (GstGLWindow * window, GError ** error)
 
   if (!display_x11->foreign_display) {
     window_x11->x11_source = x11_event_source_new (window_x11);
-    g_source_attach (window_x11->x11_source,
-        g_main_context_get_thread_default ());
+    g_source_attach (window_x11->x11_source, window->main_context);
   }
 
   window_x11->allow_extra_expose_events = TRUE;
-- 
1.9.1

